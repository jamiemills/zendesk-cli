@startuml C4-Component
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

title Component Diagram - Business Services Layer

Container_Boundary(business_services, "Business Services") {
    Component(ticket_service, "TicketService", "Python Class", "Orchestrates ticket operations, handles filtering and sorting")
    Component(auth_service, "AuthService", "Python Class", "Manages authentication state and user context")
    Component(config_service, "ConfigService", "Python Class", "Handles configuration file operations and validation")
}

Container_Boundary(api_client, "API Client") {
    Component(zendesk_client, "ZendeskClient", "Python Class", "HTTP client with retry logic and error handling")
    Component(search_client, "SearchClient", "Python Class", "Specialized client for Zendesk Search API")
}

Container_Boundary(data_models, "Data Models") {
    Component(ticket_model, "Ticket", "Pydantic Model", "Ticket data validation and business logic")
    Component(user_model, "User", "Pydantic Model", "User data validation")
    Component(group_model, "Group", "Pydantic Model", "Group data validation")
    Component(config_model, "ZendeskConfig", "Pydantic Model", "Configuration validation")
}

Container_Boundary(cli_interface, "CLI Interface") {
    Component(tickets_command, "TicketsCommand", "Click Command", "Handles ticket listing with filters")
    Component(configure_command, "ConfigureCommand", "Click Command", "Interactive configuration setup")
    Component(table_formatter, "TableFormatter", "Rich Formatter", "Formats output tables with styling")
    Component(csv_exporter, "CSVExporter", "CSV Writer", "Exports ticket data to CSV format")
}

Container_Boundary(utilities, "Utilities") {
    Component(date_utils, "DateUtils", "Python Module", "Date calculations and formatting")
    Component(logging_config, "LoggingConfig", "Python Module", "Centralized logging setup")
}

System_Ext(zendesk_api, "Zendesk API")
System_Ext(system_keyring, "System Keyring")
System_Ext(file_system, "File System")

' Service interactions
Rel(ticket_service, zendesk_client, "Uses", "API calls")
Rel(ticket_service, ticket_model, "Creates/validates")
Rel(auth_service, zendesk_client, "Uses", "Authentication")
Rel(auth_service, user_model, "Creates/validates")
Rel(config_service, config_model, "Creates/validates")

' CLI to services
Rel(tickets_command, ticket_service, "Delegates to")
Rel(tickets_command, auth_service, "Uses")
Rel(configure_command, config_service, "Uses")
Rel(configure_command, auth_service, "Uses")

' Formatting and export
Rel(tickets_command, table_formatter, "Uses")
Rel(tickets_command, csv_exporter, "Uses")
Rel(table_formatter, date_utils, "Uses")
Rel(csv_exporter, date_utils, "Uses")

' API client interactions
Rel(zendesk_client, search_client, "Delegates search")
Rel(zendesk_client, zendesk_api, "HTTPS requests")

' External dependencies
Rel(config_service, system_keyring, "Secure storage")
Rel(config_service, file_system, "File operations")
Rel(csv_exporter, file_system, "Write CSV")

@enduml